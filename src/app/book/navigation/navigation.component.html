<app-book-controls  class="hide-on-small-only"></app-book-controls>



<ng-container *ngIf="bookService.isImage()">
<div class="app-navigation-tabs" *ngIf="bookService.navigationTabsCount > 1">
  <ul class="tabs">
    <li *ngIf="bookService.allPages.length > 0"  class="tab tab-{{bookService.navigationTabsCount}}">
      <a (click)="bookService.changeNavigationTab('pages');analytics.sendEvent('viewer', 'navigation', 'pages');" [class.active]="bookService.activeNavigationTab === 'pages'">
        <span class="app-desc">{{ 'model_plural.page' | translate }}</span>
      </a>
    </li> 
    <li *ngIf="bookService.articles.length > 0"  class="tab tab-{{bookService.navigationTabsCount}}">
      <a (click)="bookService.changeNavigationTab('articles');analytics.sendEvent('viewer', 'navigation', 'articles');" [class.active]="bookService.activeNavigationTab === 'articles'">
        <span class="app-desc">{{ 'model_plural.article' | translate }}</span>
      </a>
    </li>
    <li *ngIf="bookService.internalParts.length > 0" class="tab tab-{{bookService.navigationTabsCount}}">
      <a (click)="bookService.changeNavigationTab('internalparts');analytics.sendEvent('viewer', 'navigation', 'internalparts');" [class.active]="bookService.activeNavigationTab === 'internalparts'">
        <span class="app-desc">{{ 'model_plural.internalpart' | translate }}</span>
      </a>
    </li>
    <li *ngIf="bookService.metadata.doctype == 'oldprintomnibusvolume' && bookService.extraParents.length > 0 && !bookService.getFulltextQuery()" class="tab tab-{{bookService.navigationTabsCount}}">
      <a (click)="bookService.changeNavigationTab('konvolutparts');analytics.sendEvent('viewer', 'navigation', 'konvolutparts');" [class.active]="bookService.activeNavigationTab === 'konvolutparts'">
        <span class="app-desc">{{ 'model_plural.oldprintomnibusvolumepart' | translate }}</span>
      </a>
    </li>
  </ul>
</div>

<div class="app-navigation-articles" *ngIf="bookService.activeNavigationTab === 'articles'">
  <div *ngFor="let article of bookService.articles" (click)="bookService.onArticleSelected(article)" class="app-article" [class.app-article-selected]="article === bookService.article">{{ article.title }}</div>
</div>

<div class="app-navigation-internalparts" *ngIf="bookService.activeNavigationTab === 'internalparts'">
  <div *ngFor="let internalPart of bookService.internalParts" (click)="bookService.onInternalPartSelected(internalPart)" class="app-internalpart" [class.app-internalpart-selected]="internalPart === bookService.internalPart">{{ internalPart.title }}</div>
</div>

<div class="app-navigation-internalparts" *ngIf="bookService.activeNavigationTab === 'konvolutparts'">
  <div *ngFor="let parent of bookService.extraParents" (click)="bookService.onParentSelected(parent)" class="app-internalpart" [class.app-internalpart-selected]="bookService.getPage().parentUuid === parent.pid">{{ parent.title }}</div>
</div>

<app-book-search [class.app-hidden]="bookService.activeNavigationTab !== 'pages'"></app-book-search>

<div class="app-navigation-header" *ngIf="bookService.getPageCount() > 1" [class.app-hidden]="bookService.activeNavigationTab !== 'pages'">
  <input class="app-current-page" (keyup)="onKeyUp($event)" type="text" pattern="[0-9]*" value="23" [(ngModel)]="pageIndex" mz-tooltip [tooltip]="'common.set_page_number' | translate" [position]="'top'" />
  <span>{{ 'common.of' | translate }}</span>
  <span>{{bookService.getPageCount()}}</span>
  <span>{{ 'common.of_pages' | translate }}</span>
</div>

<div class="app-navigation-pages" id="app-navigation-container" [class.app-is-query]="bookService.getFulltextQuery()" [class.app-hidden]="bookService.activeNavigationTab !== 'pages'">
  <ng-container *ngIf="!bookService.getFulltextQuery() || bookService.fulltextAllPages; else showSnippets">
    <app-navigation-item [page]="page" [container]="container" *ngFor="let page of bookService.pages" (pageSelected)="onPageSelected(page)"></app-navigation-item>
  </ng-container>
  <ng-template #showSnippets>
    <app-navigation-snippet [page]="page" [container]="container" *ngFor="let page of bookService.pages" (pageSelected)="onPageSelected(page)"></app-navigation-snippet>
  </ng-template>
</div>

</ng-container>





<ng-container *ngIf="bookService.isEpub()">

  <div class="app-epub-search-bar-wrapper" style="min-height: 45px;">
    <div class="app-epub-search-bar" [class.app-is-query]="query" *ngIf="epubService.totalPages()">
      <input (keyup.enter)="epubService.onSearch()" type="text" placeholder="Hledat" [(ngModel)]="epubService.searchQuery" />
      <i *ngIf="epubService.searchQuery" mz-icon-mdi [icon]="'close'" (click)="epubService.cleanQuery()" class="app-cursor-pointer" mz-tooltip [tooltip]="'searchbar.delete_query' | translate" [position]="'top'"></i>
      <i mz-icon-mdi [icon]="'magnify'" (click)="epubService.onSearch()"  class="app-cursor-pointer"></i>
    </div>
  </div>

  <div class="app-navigation-header" style="min-height: 44px;">
    <ng-container *ngIf="epubService.totalPages() && !epubService.searching">
      <input class="app-current-page" [value]="epubService.location ? epubService.location.page : 0" (change)="epubService.goToPage($event.target.value)" type="text" pattern="[0-9]*" mz-tooltip [tooltip]="'common.set_page_number' | translate" [position]="'top'" />
      <span>{{ 'common.of' | translate }}</span>
      <span>{{ epubService.totalPages() }}</span>
      <span style="margin-left: 7px;">{{ 'common.of_pages' | translate }}</span>
      <i mz-icon-mdi [icon]="epubTocExpanded ? 'chevron-down' : 'chevron-left'" style="float:right; height: 30px; cursor: pointer; color: #888;" (click)="epubTocExpanded = !epubTocExpanded"></i>
    </ng-container>
  </div>

  <div class="app-navigation-toc" *ngIf="!epubService.searching">
    <ng-container *ngFor="let item of epubService.toc">
      <div class="app-item" [class.app-item-selected]="epubService.isChapterSelected(item)" (click)="epubService.goToChapter(item)">{{ item.label.trim() }}</div>
      <ng-container *ngIf="epubTocExpanded">
        <ng-container *ngFor="let subitem of item.subitems">
          <div class="app-item app-sub" (click)="epubService.goToChapter(subitem)">{{ subitem.label.trim() }}</div>
          <div *ngFor="let subsubitem of subitem.subitems" class="app-item app-sub-sub" (click)="epubService.goToChapter(subsubitem)">{{ subsubitem.label.trim() }}</div>
        </ng-container>
      </ng-container>
    </ng-container>
  </div>

  <div class="app-navigation-toc" *ngIf="epubService.searching">
    <div *ngFor="let item of epubService.searchResults" class="app-item" (click)="epubService.goToSnippet(item)">
      <span [innerHTML]="item.snippet | safeHtml"></span>
    </div>
  </div>

</ng-container>







<ng-container *ngIf="bookService.isPdf()">

  <div class="app-navigation-articles" *ngIf="bookService.activeNavigationTab === 'articles'; else pdfNav">
    <div *ngFor="let article of bookService.articles" (click)="bookService.onArticleSelected(article)" class="app-article" [class.app-article-selected]="article === bookService.article">{{ article.title }}</div>
  </div>

  <ng-template #pdfNav>
    <div class="app-epub-search-bar-wrapper" style="min-height: 45px;">
      <div class="app-epub-search-bar" [class.app-is-query]="query" *ngIf="pdfService.totalPages">
        <input (keyup.enter)="pdfService.onSearch()" type="text" placeholder="Hledat" [(ngModel)]="pdfService.searchQuery" />
        <i *ngIf="pdfService.searchQuery" mz-icon-mdi [icon]="'close'" (click)="pdfService.cleanQuery()" class="app-cursor-pointer" mz-tooltip [tooltip]="'searchbar.delete_query' | translate" [position]="'top'"></i>
        <i mz-icon-mdi [icon]="'magnify'" (click)="pdfService.onSearch()"  class="app-cursor-pointer"></i>
      </div>
    </div>
  
    <div class="app-navigation-header" style="min-height: 44px;">
      <ng-container *ngIf="pdfService.totalPages && !pdfService.searching">
        <input class="app-current-page" [value]="pdfService.pageIndex" (change)="pdfService.goToPage($event.target.value)" type="text" pattern="[0-9]*" mz-tooltip [tooltip]="'common.set_page_number' | translate" [position]="'top'" />
        <span>{{ 'common.of' | translate }}</span>
        <span>{{ pdfService.totalPages }}</span>
        <span style="margin-left: 7px;">{{ 'common.of_pages' | translate }}</span>
        <i mz-icon-mdi [icon]="epubTocExpanded ? 'chevron-down' : 'chevron-left'" style="float:right; height: 30px; cursor: pointer; color: #888;" (click)="epubTocExpanded = !epubTocExpanded"></i>
      </ng-container>
    </div>

    <div class="app-navigation-toc" *ngIf="!pdfService.searching">
      <ng-container *ngFor="let item of pdfService.outline">
        <div class="app-item" (click)="pdfService.goTo(item.dest)">{{ item.title.trim() }}</div>
        <ng-container *ngIf="epubTocExpanded">
          <ng-container *ngFor="let subitem of item.items">
            <div class="app-item app-sub" (click)="pdfService.goTo(subitem.dest)">{{ subitem.title.trim() }}</div>
          </ng-container>
        </ng-container>
      </ng-container>
    </div>
  </ng-template>




  <!-- <div class="app-navigation-toc" *ngIf="epubService.searching">
    <div *ngFor="let item of epubService.searchResults" class="app-item" (click)="epubService.goToSnippet(item)">
      <span [innerHTML]="item.snippet | safeHtml"></span>
    </div>
  </div> -->

</ng-container>


